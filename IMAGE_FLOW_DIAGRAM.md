# Image Helper - Flow Diagram

## ğŸ”„ Alur Kerja ImageHelper

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND API                              â”‚
â”‚  Mengirim Response dengan path relatif gambar                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  API Response  â”‚
                    â”‚  {             â”‚
                    â”‚   urlSampul:   â”‚
                    â”‚   "/storage/   â”‚
                    â”‚    sampul.jpg" â”‚
                    â”‚  }             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         Flutter App receives          â”‚
        â”‚         NaskahData with               â”‚
        â”‚         urlSampul: "/storage/..."     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘       ImageHelper.getFullImageUrl()  â•‘
        â•‘                                      â•‘
        â•‘  1. Check if URL is null/empty       â•‘
        â•‘     â†’ Return ''                      â•‘
        â•‘                                      â•‘
        â•‘  2. Check if URL starts with http    â•‘
        â•‘     â†’ Return as-is                   â•‘
        â•‘                                      â•‘
        â•‘  3. Get BASE_URL from .env           â•‘
        â•‘     â†’ "http://10.0.2.2:4000"         â•‘
        â•‘                                      â•‘
        â•‘  4. Clean BASE_URL (remove /)        â•‘
        â•‘     â†’ "http://10.0.2.2:4000"         â•‘
        â•‘                                      â•‘
        â•‘  5. Clean path (ensure /)            â•‘
        â•‘     â†’ "/storage/sampul.jpg"          â•‘
        â•‘                                      â•‘
        â•‘  6. Combine BASE_URL + path          â•‘
        â•‘     â†’ "http://10.0.2.2:4000/         â•‘
        â•‘        storage/sampul.jpg"           â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         Full URL Generated           â”‚
        â”‚  "http://10.0.2.2:4000/storage/      â”‚
        â”‚   sampul/buku-123.jpg"               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        Image.network(fullUrl)        â”‚
        â”‚                                      â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
        â”‚  â”‚  Loading State          â”‚       â”‚
        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
        â”‚  â”‚  â”‚ CircularProgress â”‚   â”‚       â”‚
        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
        â”‚                â”‚                    â”‚
        â”‚                â–¼                    â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
        â”‚  â”‚  Success State          â”‚       â”‚
        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
        â”‚  â”‚  â”‚   Image Loaded   â”‚   â”‚       â”‚
        â”‚  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚       â”‚
        â”‚  â”‚  â”‚   â”‚  [IMG]   â”‚   â”‚   â”‚       â”‚
        â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚       â”‚
        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
        â”‚             OR                      â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
        â”‚  â”‚  Error State            â”‚       â”‚
        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
        â”‚  â”‚  â”‚  Broken Image    â”‚   â”‚       â”‚
        â”‚  â”‚  â”‚  Icon + Message  â”‚   â”‚       â”‚
        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Decision Tree

```
Input URL String
       â”‚
       â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Null? â”‚â”€â”€â”€â”€Yesâ”€â”€â”€â”€â–¶ Return ""
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
       â”‚ No
       â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
   â”‚Empty? â”‚â”€â”€â”€â”€Yesâ”€â”€â”€â”€â–¶ Return ""
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
       â”‚ No
       â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Starts withâ”‚
   â”‚  http:// ? â”‚â”€â”€â”€â”€Yesâ”€â”€â”€â”€â–¶ Return as-is
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚ No
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Starts withâ”‚
   â”‚ https:// ? â”‚â”€â”€â”€â”€Yesâ”€â”€â”€â”€â–¶ Return as-is
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚ No (Relative path)
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Get BASE_URL   â”‚
   â”‚ from .env      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Clean BASE_URL â”‚
   â”‚ (remove /)     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Clean path     â”‚
   â”‚ (ensure /)     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Combine both   â”‚
   â”‚ BASE + path    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   Return Full URL
```

## ğŸ” Examples by Input Type

### Type 1: Relative Path
```
Input:  "/storage/sampul/buku-123.jpg"
        â”‚
        â–¼
Check:  Not null âœ“
        Not empty âœ“
        Not http:// âœ—
        Not https:// âœ—
        â”‚
        â–¼
Process: BASE_URL + path
         "http://10.0.2.2:4000" + "/storage/sampul/buku-123.jpg"
        â”‚
        â–¼
Output: "http://10.0.2.2:4000/storage/sampul/buku-123.jpg"
```

### Type 2: Absolute HTTP URL
```
Input:  "http://example.com/image.jpg"
        â”‚
        â–¼
Check:  Not null âœ“
        Not empty âœ“
        Starts with http:// âœ“
        â”‚
        â–¼
Output: "http://example.com/image.jpg" (unchanged)
```

### Type 3: Absolute HTTPS URL
```
Input:  "https://picsum.photos/300/400"
        â”‚
        â–¼
Check:  Not null âœ“
        Not empty âœ“
        Not http:// âœ—
        Starts with https:// âœ“
        â”‚
        â–¼
Output: "https://picsum.photos/300/400" (unchanged)
```

### Type 4: Null Input
```
Input:  null
        â”‚
        â–¼
Check:  Is null âœ“
        â”‚
        â–¼
Output: ""
```

### Type 5: Empty String
```
Input:  ""
        â”‚
        â–¼
Check:  Not null âœ“
        Is empty âœ“
        â”‚
        â–¼
Output: ""
```

## ğŸ¨ UI Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Book Card Widget                    â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cover Image Container                     â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚  book.imageUrl != null?                   â”‚ â”‚
â”‚  â”‚         â”‚                                  â”‚ â”‚
â”‚  â”‚         â”œâ”€ Yes â”€â”€â–¶ ImageHelper.getFullUrl â”‚ â”‚
â”‚  â”‚         â”‚              â”‚                   â”‚ â”‚
â”‚  â”‚         â”‚              â–¼                   â”‚ â”‚
â”‚  â”‚         â”‚         Image.network(fullUrl)  â”‚ â”‚
â”‚  â”‚         â”‚              â”‚                   â”‚ â”‚
â”‚  â”‚         â”‚              â”œâ”€ Loading â”€â”€â–¶ â³   â”‚ â”‚
â”‚  â”‚         â”‚              â”œâ”€ Success â”€â”€â–¶ ğŸ–¼ï¸   â”‚ â”‚
â”‚  â”‚         â”‚              â””â”€ Error â”€â”€â”€â–¶ âŒ   â”‚ â”‚
â”‚  â”‚         â”‚                                  â”‚ â”‚
â”‚  â”‚         â””â”€ No â”€â”€â”€â–¶ Placeholder Icon ğŸ“•    â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚  Book Title: "Buku Saya"                        â”‚
â”‚  Author: "Penulis XYZ"                          â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“± Implementation Locations

```
mobile-publishify/
â””â”€â”€ publishify/
    â””â”€â”€ lib/
        â”œâ”€â”€ utils/
        â”‚   â””â”€â”€ image_helper.dart â—„â”€â”€â”€ CORE LOGIC
        â”‚
        â”œâ”€â”€ widgets/
        â”‚   â”œâ”€â”€ cards/
        â”‚   â”‚   â””â”€â”€ book_card.dart â—„â”€â”€â”€ Uses ImageHelper
        â”‚   â”œâ”€â”€ print_card.dart â—„â”€â”€â”€ Uses ImageHelper
        â”‚   â”œâ”€â”€ percetakan_card.dart â—„â”€â”€â”€ Uses ImageHelper
        â”‚   â””â”€â”€ profile/
        â”‚       â””â”€â”€ portfolio_item.dart â—„â”€â”€â”€ Uses ImageHelper
        â”‚
        â””â”€â”€ pages/
            â”œâ”€â”€ profile/
            â”‚   â””â”€â”€ profile_page.dart â—„â”€â”€â”€ Uses ImageHelper (2x)
            â””â”€â”€ demo/
                â””â”€â”€ image_helper_demo_page.dart â—„â”€â”€â”€ Test/Demo
```

## ğŸ§ª Test Coverage Map

```
image_helper_test.dart
â”œâ”€â”€ Group: getFullImageUrl()
â”‚   â”œâ”€â”€ âœ… Relative path â†’ Full URL
â”‚   â”œâ”€â”€ âœ… HTTP URL unchanged
â”‚   â”œâ”€â”€ âœ… HTTPS URL unchanged
â”‚   â”œâ”€â”€ âœ… Null â†’ Empty string
â”‚   â”œâ”€â”€ âœ… Empty â†’ Empty string
â”‚   â”œâ”€â”€ âœ… Path without slash
â”‚   â””â”€â”€ âœ… BASE_URL with trailing slash
â”‚
â”œâ”€â”€ Group: isValidImageUrl()
â”‚   â”œâ”€â”€ âœ… Valid URL â†’ true
â”‚   â”œâ”€â”€ âœ… Null â†’ false
â”‚   â””â”€â”€ âœ… Empty â†’ false
â”‚
â”œâ”€â”€ Group: getPlaceholderUrl()
â”‚   â””â”€â”€ âœ… Returns placeholder URL
â”‚
â””â”€â”€ Group: Real-world scenarios
    â”œâ”€â”€ âœ… Sampul naskah dari backend
    â”œâ”€â”€ âœ… Avatar eksternal (Gravatar)
    â”œâ”€â”€ âœ… Gambar percetakan
    â””â”€â”€ âœ… Missing image handling

Total: 15 tests, All passing âœ…
```
